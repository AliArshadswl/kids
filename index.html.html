<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生字消消乐</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }
        
        body {
            background-color: #e0f2e0;
            font-family: 'Microsoft YaHei', sans-serif;
            padding: 20px;
            text-align: center;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        header {
            margin-bottom: 30px;
            width: 100%;
        }
        
        h1 {
            color: #2e7d32;
            font-size: 3rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            margin-bottom: 10px;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            width: 90%;
            max-width: 800px;
            margin: 0 auto 20px;
            padding: 10px 20px;
            background-color: #a5d6a7;
            border-radius: 50px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .timer, .score {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1b5e20;
        }
        
        .game-container {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 16px;
            width: 90%;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .bubble {
            width: 100%;
            aspect-ratio: 1;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 
                0 10px 20px rgba(0, 0, 0, 0.2),
                inset 0 -8px 15px rgba(0, 0, 0, 0.1),
                inset 0 8px 15px rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .bubble::after {
            content: '';
            position: absolute;
            top: 10%;
            left: 15%;
            width: 30%;
            height: 20%;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            transform: rotate(25deg);
        }
        
        .bubble.selected {
            transform: scale(1.1);
            box-shadow: 
                0 0 25px rgba(255, 215, 0, 0.8),
                0 10px 20px rgba(0, 0, 0, 0.2),
                inset 0 -8px 15px rgba(0, 0, 0, 0.1),
                inset 0 8px 15px rgba(255, 255, 255, 0.3);
        }
        
        .bubble.matched {
            visibility: hidden;
            opacity: 0;
            transform: scale(0);
            transition: all 0.5s ease;
        }
        
        .controls {
            margin-top: 30px;
        }
        
        button {
            padding: 12px 25px;
            background-color: #4caf50;
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        
        button:hover {
            background-color: #2e7d32;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        .success-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(255, 255, 255, 0.95);
            padding: 30px 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 100;
            text-align: center;
            display: none;
        }
        
        .success-message h2 {
            color: #2e7d32;
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        
        .success-message p {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #333;
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 99;
            display: none;
        }

        /* 小屏优化 */
        @media (max-width: 640px) {
            h1 { font-size: 2rem; }
            .bubble { font-size: 1.4rem; }
            .game-info { font-size: 1rem; }
        }
    </style>
</head>
<body>
    <header>
        <h1>生字消消乐</h1>
    </header>
    
    <div class="game-info">
        <div class="timer">时间: <span id="time">0</span>秒</div>
        <div class="score">配对: <span id="pairs">0</span>/9</div>
    </div>
    
    <div class="game-container" id="game-container"></div>
    
    <div class="controls">
        <button id="restart">继续挑战</button>
    </div>
    
    <div class="overlay" id="overlay"></div>
    
    <div class="success-message" id="success-message" role="dialog" aria-live="polite">
        <h2>恭喜挑战成功！</h2>
        <p>用时: <span id="final-time">0</span>秒</p>
        <button id="play-again">再玩一次</button>
    </div>

    <script>
        // 生字和拼音数据
        const wordData = [
            { word: '爱', pinyin: 'ài' },
            { word: '白', pinyin: 'bái' },
            { word: '车', pinyin: 'chē' },
            { word: '大', pinyin: 'dà' },
            { word: '飞', pinyin: 'fēi' },
            { word: '高', pinyin: 'gāo' },
            { word: '好', pinyin: 'hǎo' },
            { word: '家', pinyin: 'jiā' },
            { word: '看', pinyin: 'kàn' },
            { word: '老', pinyin: 'lǎo' },
            { word: '妈', pinyin: 'mā' },
            { word: '你', pinyin: 'nǐ' },
            { word: '朋', pinyin: 'péng' },
            { word: '前', pinyin: 'qián' },
            { word: '人', pinyin: 'rén' },
            { word: '山', pinyin: 'shān' },
            { word: '天', pinyin: 'tiān' },
            { word: '我', pinyin: 'wǒ' }
        ];

        // 游戏状态变量
        let selectedBubbles = [];
        let matchedPairs = 0;
        let startTime = 0;
        let timerInterval = null;
        let currentGameWords = [];

        // DOM 元素
        const gameContainer = document.getElementById('game-container');
        const timeElement = document.getElementById('time');
        const pairsElement = document.getElementById('pairs');
        const restartButton = document.getElementById('restart');
        const playAgainButton = document.getElementById('play-again');
        const successMessage = document.getElementById('success-message');
        const overlay = document.getElementById('overlay');
        const finalTimeElement = document.getElementById('final-time');

        // 初始化游戏
        function initGame() {
            // 重置游戏状态
            selectedBubbles = [];
            matchedPairs = 0;
            gameContainer.innerHTML = '';
            pairsElement.textContent = '0';
            
            // 停止之前的计时器
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            // 开始计时
            startTime = Date.now();
            timerInterval = setInterval(updateTimer, 1000);
            
            // 随机选择9个生字
            currentGameWords = getRandomWords(9);
            
            // 创建泡泡
            createBubbles();
        }

        // 获取随机生字
        function getRandomWords(count) {
            const shuffled = [...wordData].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }

        // 创建泡泡
        function createBubbles() {
            // 创建生字和拼音数组
            const words = currentGameWords.map(item => item.word);
            const pinyins = currentGameWords.map(item => item.pinyin);
            
            // 合并并打乱顺序
            const allItems = [...words, ...pinyins];
            shuffleArray(allItems);
            
            // 创建泡泡
            allItems.forEach(item => {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                bubble.textContent = item;
                bubble.setAttribute('aria-label', '泡泡 ' + item);
                
                // 随机颜色
                const hue = Math.floor(Math.random() * 360);
                bubble.style.background = `radial-gradient(circle at 30% 30%, hsl(${hue}, 100%, 75%), hsl(${hue}, 100%, 45%))`;
                bubble.style.color = hue > 50 && hue < 230 ? '#333' : '#fff';
                
                // 添加点击事件
                bubble.addEventListener('click', () => handleBubbleClick(bubble, item));
                
                gameContainer.appendChild(bubble);
            });
        }

        // 处理泡泡点击
        function handleBubbleClick(bubble, value) {
            // 如果已完成弹窗显示，则忽略点击
            if (overlay.style.display === 'block') return;

            // 如果已经匹配或者是已经选中的泡泡，则忽略
            if (bubble.classList.contains('matched') || bubble.classList.contains('selected')) {
                return;
            }
            
            // 选中泡泡
            bubble.classList.add('selected');
            selectedBubbles.push({ bubble, value });
            
            // 限制最多只保留两个被选中
            if (selectedBubbles.length > 2) {
                const first = selectedBubbles.shift();
                first.bubble.classList.remove('selected');
            }

            // 如果选中了两个泡泡，检查是否匹配
            if (selectedBubbles.length === 2) {
                const [first, second] = selectedBubbles;
                
                // 检查是否匹配（一个是生字，一个是对应拼音）
                const isMatch = currentGameWords.some(item => 
                    (item.word === first.value && item.pinyin === second.value) ||
                    (item.word === second.value && item.pinyin === first.value)
                );
                
                if (isMatch) {
                    // 匹配成功
                    setTimeout(() => {
                        first.bubble.classList.add('matched');
                        second.bubble.classList.add('matched');
                        
                        selectedBubbles = [];
                        matchedPairs++;
                        pairsElement.textContent = matchedPairs;
                        
                        // 检查游戏是否完成
                        if (matchedPairs === currentGameWords.length) {
                            gameComplete();
                        }
                    }, 300);
                } else {
                    // 不匹配
                    setTimeout(() => {
                        first.bubble.classList.remove('selected');
                        second.bubble.classList.remove('selected');
                        selectedBubbles = [];
                    }, 700);
                }
            }
        }

        // 更新计时器
        function updateTimer() {
            const elapsedTime = Math.floor((Date.now() - startTime) / 1000);
            timeElement.textContent = elapsedTime;
        }

        // 游戏完成
        function gameComplete() {
            clearInterval(timerInterval);
            const elapsedTime = Math.floor((Date.now() - startTime) / 1000);
            finalTimeElement.textContent = elapsedTime;
            
            // 显示成功消息
            setTimeout(() => {
                overlay.style.display = 'block';
                successMessage.style.display = 'block';
            }, 400);
        }

        // 数组随机排序
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // 事件监听
        restartButton.addEventListener('click', initGame);
        playAgainButton.addEventListener('click', () => {
            overlay.style.display = 'none';
            successMessage.style.display = 'none';
            initGame();
        });

        // 初始加载游戏
        initGame();
    </script>
</body>
</html>
